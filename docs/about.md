## Antivirus Flaws

This repository contains source code and documentation for a proof of concept on how trivial it is to take known malicious code as shellcode and structures them in such a way that the bytes of the malicious code will not match the antivirus signature known and associated with it.

### Contents

[scramblePayload.py][1] - A script written in Python3 to take the output from msfvenom as stdin and convert it to the C++ code to be pasted in the skeletonized POC. Allows you to specify the chunk size and the variable name you want given. It takes -c for the chunkSize and -vn for the C++ variable name. It returns the following items:
	
	- Randomized chunks of size given.
	- A string pointer array to all of the strings of chunks in the correct order.
	- An int of the count of the chunks.
	- An int of the total size of the payload.
	- A vector of type string* that will be instantiated to the contents of the string pointer array.

[AVBypass_POC.cpp][2] - A C++ source code containing proof of concept for the antivirus evasion method of chunking described above. The C++ code generated by the scramblePayload.py script is taken and dumped into the section commented in the Payload class as private members. This POC can be expanded upon to create trojans that serve any functions that can be expressed as shellcode. Coding the functions that are desired in assembly would give the ability to routinely change the signature in an effort to remain undetected.

### Usage

Generation of C++ code for shellcode:
```
msfvenom [options] -f hex | ./scramblePayload.py -c [ChunkSize] -vn [Variable Name]
```
Copy and paste the relevant output into the skeletonized POC

### Software used in development:

	-Visual Studio Community 2017
	-Python 3.6.4
[1]: https://github.com/jakehomb/Antivirus_Flaws/blob/master/scramblePayload.py
[2]: https://github.com/jakehomb/Antivirus_Flaws/blob/master/AVBypass_Skeletonized.cpp
